<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Installation · Aswing</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Aswing</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li class="current"><a class="toctext" href="install.html">Installation</a><ul class="internal"><li><a class="toctext" href="#Installation-1">Installation</a></li><li><a class="toctext" href="#Rebuilding-1">Rebuilding</a></li></ul></li><li><a class="toctext" href="example.html">Example Usage</a></li><li><a class="toctext" href="library.html">Library</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="install.html">Installation</a></li></ul><a class="edit-page" href="https://github.com/byuflowlab/Aswing.jl/blob/master/docs/src/install.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Installation</span><a class="fa fa-bars" href="#"></a></div></header><h2><a class="nav-anchor" id="Installation-1" href="#Installation-1">Installation</a></h2><p>As ASWING is designed to be a standalone program, several modifications must be made to the original program to allow direct interaction with the program through Julia (and to prevent it from launching GUIs).  This section will guide you through the installation process.</p><p>Start by checking out this package for development:</p><pre><code class="language-none">(v1.0) pkg&gt; dev https://github.com/byuflowlab/Aswing.jl</code></pre><p>Julia will automatically try (and fail) to build the package. This is ok, because we weren&#39;t ready to build the package anyway.</p><p>Then copy the contents of ASWING&#39;s src directory into the ~/.julia/dev/Aswing/deps/src/aswing/src directory.  Plotting packages are not used by this wrapper and do not need to be copied over.</p><p>Then make the following necessary changes to the source code:</p><ul><li><p>In aswing.f:</p><ul><li>Delete <code>LOWRIT</code> function (aswing.f: lines 466-479)</li></ul></li><li><p>In exec.f:</p><ul><li>Decrease <code>TOLS</code> and <code>TOLU</code> (exec.f: line 17) to 1e-10 by changing<pre><code class="language-none">      DATA TOLS, TOLU / 0.00010 , 0.001 /</code></pre>to:<pre><code class="language-none">      DATA TOLS, TOLU / 1e-10 , 1e-10 /</code></pre></li></ul></li><li><p>In init.f:</p><ul><li>Replace the following lines of code in the <code>THCALC</code> subroutine (init.f: line 2599)</li></ul><p><code>IBREAK(KB+1) = INT( FLOAT(NINT)*DFRAC + 0.499 )</code>   with:   <code>IBREAK(KB+1) = INT( FLOAT(NINT)*DFRAC + 0.499 )           IF (CUSTOMINTERVALS) THEN               IBREAK(KB+1) = INTERVALS(KB+1)           ENDIF</code></p><ul><li>In the same subroutine (<code>THCALC</code>) replace (init.f: line 2520)<pre><code class="language-none">      IMPLICIT REAL (A-H,M,O-Z)</code></pre>with<pre><code class="language-none">      IMPLICIT REAL (A-H,M,O-Z)
      INCLUDE &#39;THCALC.INC&#39;</code></pre></li></ul></li><li><p>In io.f:</p><ul><li>Replace <code>SUBROUTINE DUMPDM(LU, IPNT)</code> (io.f: line 1927) with:<pre><code class="language-none">      SUBROUTINE DUMPDM(LU, F_VBA, M_VBA, F_ROT,
     &amp; M_ROT, F_FLAP, M_FLAP, F_PENG, M_PENG, IPNT)</code></pre></li><li>Delete the following lines from <code>BINPUT</code> (io.f: lines 20-34)<pre><code class="language-none">C---- read configuration-definition file
      LU = 1
      OPEN(LU,FILE=FILNAM,STATUS=&#39;OLD&#39;,ERR=99)
      CALL BINPUT(LU,IBX,JBX,
     &amp;            NBX, NBEAM, NB, QB, TB, BNAME, KBNUM,IBEAM,
     &amp;            NJX, NJOIN, TJOIN, KBJOIN, KJTYPE,
     &amp;            NGX, NGROU, TGROU, KBGROU, KGTYPE,
     &amp;       KPX, NPX, NPYLO, QPYLO, KBPYLO, KPTYPE,
     &amp;     NENGX, IENGTYP,
     &amp;            NAJX,NANGJ, MOMJ, ANGJ, HJAX,
     &amp;            UNITL, UNITM, UNITT, UNITF,
     &amp;            UNCHL, UNCHM, UNCHT, UNCHF,
     &amp;            GEEW, RHOSL, VSOSL, SREF,CREF,BREF,XYZREF,
     &amp;            NAME )
      CLOSE(LU)</code></pre></li></ul></li><li><p>In iosubs.f:</p><ul><li>Fix <code>LBSYMM</code> bug in <code>OUTPUT</code> (iosubs.f: line 1417) by changing<pre><code class="language-none">      LOGICAL LBSYMM(JBX,NBX)</code></pre>to:<pre><code class="language-none">      LOGICAL LBSYMM(0:JBX,NBX)</code></pre></li><li>Also fix output bug (iosubs.f: line 1817) by changing<pre><code class="language-none">        ELSEIF( IPTYPE.EQ.3 .AND. KPTYPE(KP).GT.10      ) THEN</code></pre>to:<pre><code class="language-none">        ELSEIF( IPTYPE.EQ.3 .AND. KPTYPE(KP).GT.10
     &amp; .AND. KPTYPE(KP).LT.100) THEN</code></pre></li></ul></li><li><p>In oper.f:</p><ul><li><p>Add the following line at the end of the unsteady solution loop to prevent Aswing from solving additional time steps upon solution failure during an unsteady simulation (oper.f: line 822)</p><pre><code class="language-none">      IF(.NOT.LCONV(IPOINT)) EXIT</code></pre></li><li><p>Delete the lines which prompt for DELTAT and NTIMES (oper.f: line 712-716)</p><pre><code class="language-none">        WRITE(*,2052) DELTAT, NTIMES
 2052   FORMAT(
     &amp;   /&#39; Enter delta(t), Nstep  (-Nstep to append steps)&#39;, F9.5, I8)
        CALL READR(2,AINPUT,ERROR)
        IF(ERROR) GO TO 52</code></pre></li><li><p>Change <code>GO TO 530</code> to <code>GO TO 500</code> when checking if point index was input (oper.f: line 133)</p></li><li><p>Delete the line which prompts for OPER menu input (oper.f: 92)</p><pre><code class="language-none">      CALL ASKARG(PROMPT,COMAND,COMARG)</code></pre></li><li><p>Move <code>500 CONTINUE</code> (oper.f: line 45) and <code>510  CONTINUE</code> (oper.f: line 83) to end of <code>OPER</code> subroutine (oper.f: line 1383)</p></li><li><p>Delete <code>STEADY = .TRUE.</code> line (oper.f: line 37)</p></li><li><p>Delete the following lines (oper.f: lines 32-34)</p><pre><code class="language-none">      SAVE DELTAT, NTIMES
      DATA DELTAT / 0.1 /
      DATA NTIMES / 10  /</code></pre></li><li><p>Add inputs to subroutine <code>OPER</code> (oper.f: line 2) by changing</p><pre><code class="language-none">      SUBROUTINE OPER</code></pre><p>to</p><pre><code class="language-none">      SUBROUTINE OPER(COMAND, COMARG, DELTAT, NTIMES)</code></pre></li></ul></li><li><p>In setup.f:</p><ul><li>Fix bug in subroutine <code>GLLCLR</code> (setup.f: line 1867) by adding<pre><code class="language-none">      LADT(1) = 0
      LADT(2) = 0
      LADT(3) = 0</code></pre>to the subroutine.</li></ul></li></ul><p>You may also want to remove (or comment out) a number of <code>WRITE</code> statements from the original code to prevent ASWING from printing a plethora of information.  These include, but are not limited to the following lines in the original source code:</p><ul><li>cexec.f: 483; 524; 570; 688; 769-771; 843-844; 1046-1068; 1081-1084</li><li>exec.f: 26-27; 30-31;</li><li>io.f: 39; 131-143; 352-364; 531-534; 596-599; 710-711; 742; 2248-2521</li><li>iosubs.f: 2052</li><li>init.f: 1047-1051</li><li>oper.f: 54; 128; 184-185; 263-264; 548-549; 601; 600-607; 712-714; 819-820; 852-893; 1391-1392</li><li>update.f: 370-384</li></ul><p>After performing the changes listed above, build the package to automatically build a shared library that Julia can call.</p><pre><code class="language-none">(v1.0) pkg&gt; build Aswing</code></pre><p>You are now ready to use the Aswing.jl package.</p><p>Note that if you wish to change the file DIMEN.INC to increase FORTRAN array limits, the file dimenglobals.jl must also be modified and the package must be rebuilt.</p><h2><a class="nav-anchor" id="Rebuilding-1" href="#Rebuilding-1">Rebuilding</a></h2><p>Rebuilding the package will automatically regenerate the shared library.</p><pre><code class="language-none">(v1.0) pkg&gt; build Aswing</code></pre><footer><hr/><a class="previous" href="index.html"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="example.html"><span class="direction">Next</span><span class="title">Example Usage</span></a></footer></article></body></html>
